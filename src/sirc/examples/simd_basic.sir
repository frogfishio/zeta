unit simd_basic target host +simd:v1

type V4i32 = vec(i32, 4)
type V4b = vec(bool, 4)

fn main() -> i32 public
  let x: i32 = 7:i32
  let v: V4i32 = vec.splat(x) as V4i32
  let w: V4i32 = vec.add(v, v) as V4i32
  let m: V4b = vec.cmp.eq(v, w) as V4b
  let s: V4i32 = vec.select(m, w, v) as V4i32
  let y: i32 = vec.extract(s, 2:i32) as i32
  let z: V4i32 = vec.replace(s, 0:i32, y) as V4i32
  return vec.extract(z, 0:i32) as i32
end
